import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

movies = pd.read_csv("movies.csv")
ratings = pd.read_csv("ratings.csv")

print("Movies dataset:\n", movies.head())
print("Ratings dataset:\n", ratings.head())

print("Movies dataset info:")
print(movies.info())
print("\nRatings dataset description:")
print(ratings.describe())

movie_data = pd.merge(ratings, movies, on='movieId')
print(movie_data.head())

print("Total ratings:", movie_data.shape[0])
print("Unique users:", movie_data['userId'].nunique())
print("Unique movies:", movie_data['movieId'].nunique())

plt.figure(figsize=(6,4))
sns.countplot(x='rating', data=movie_data)
plt.title('Ratings Distribution')
plt.xlabel('Rating')
plt.ylabel('Count')
plt.show()

top_movies = movie_data.groupby('title')['rating'].count().sort_values(ascending=False).head(10)
print("Top 10 most rated movie-")
print(top_movies)

avg_ratings = movie_data.groupby('title')['rating'].mean().sort_values(ascending=False).head(10)
print("Top 10 movies by average rating.")
print(avg_ratings)

movie_data.isnull().sum()

user_movie_matrix = movie_data.pivot_table(index='userId', columns='title', values='rating')

user_movie_matrix.fillna(0, inplace=True)

movie_similarity_pearson = user_movie_matrix.corr(method='pearson')
print(movie_similarity_pearson.head())

def recommend_movies_pearson(movie_name, num_recommendations=5):
    if movie_name not in movie_similarity_pearson:
        return "Movie not found in dataset."
    similar_scores = movie_similarity_pearson[movie_name].dropna().sort_values(ascending=False)[1:num_recommendations+1]
    return similar_scores

movie_name = "Toy Story (1995)"
recommendations_pearson = recommend_movies_pearson(movie_name, 5)
print(f"Top 5 movies similar to '{movie_name}' using Pearson correlation:\n")
print(recommendations_pearson)

recommendations_pearson.plot(kind='barh', color='orange')
plt.title(f"Movies similar to {movie_name} (Pearson Correlation)")
plt.xlabel("Correlation Score")
plt.ylabel("Movies")
plt.show()
